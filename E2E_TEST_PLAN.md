# 端到端测试计划
# End-to-End Test Plan

本文档定义了使用Playwright MCP进行端到端测试的完整计划，覆盖100%功能。

This document defines a complete E2E test plan using Playwright MCP to cover 100% of functionality.

## 测试环境

- **前端地址**：http://localhost:3001
- **后端地址**：http://localhost:8001
- **测试工具**：Playwright MCP (Browser MCP)

## 测试覆盖范围

### 1. 基础功能测试

#### 1.1 应用启动和导航
- [ ] 访问首页，验证应用正常加载
- [ ] 验证品牌显示为"质信智购"
- [ ] 验证Logo正确显示
- [ ] 验证导航菜单正常显示
- [ ] 验证所有导航链接可点击

#### 1.2 健康检查
- [ ] 访问后端健康检查端点
- [ ] 验证所有服务状态正常

### 2. 项目管理功能测试

#### 2.1 创建项目
- [ ] 点击"创建新助手"按钮
- [ ] 输入项目名称
- [ ] 提交创建请求
- [ ] 验证项目创建成功
- [ ] 验证项目显示在列表中

#### 2.2 项目列表
- [ ] 访问项目列表页面
- [ ] 验证项目列表正常显示
- [ ] 验证分页功能（如有）
- [ ] 验证搜索功能（如有）

#### 2.3 项目详情
- [ ] 点击项目进入详情页
- [ ] 验证项目信息正确显示
- [ ] 验证工作流信息显示

#### 2.4 更新项目
- [ ] 编辑项目名称
- [ ] 更新项目配置
- [ ] 验证更新成功

#### 2.5 删除项目
- [ ] 删除项目
- [ ] 验证删除确认对话框
- [ ] 验证项目从列表中移除

### 3. 工作流编辑器测试

#### 3.1 工作流编辑
- [ ] 进入工作流编辑器
- [ ] 验证编辑器正常加载
- [ ] 验证所有实体列表显示（Agents, Tools, Prompts, Pipelines, Data Sources）

#### 3.2 创建智能体
- [ ] 点击"添加智能体"
- [ ] 输入智能体名称和描述
- [ ] 配置智能体指令
- [ ] 选择模型
- [ ] 保存智能体
- [ ] 验证智能体出现在列表中

#### 3.3 编辑智能体
- [ ] 点击智能体进行编辑
- [ ] 修改智能体配置
- [ ] 保存更改
- [ ] 验证更改生效

#### 3.4 创建工具
- [ ] 添加工具
- [ ] 配置工具参数
- [ ] 保存工具
- [ ] 验证工具出现在列表中

#### 3.5 创建提示词
- [ ] 添加提示词
- [ ] 配置提示词内容
- [ ] 保存提示词
- [ ] 验证提示词出现在列表中

#### 3.6 创建管道
- [ ] 添加管道
- [ ] 配置管道中的智能体顺序
- [ ] 保存管道
- [ ] 验证管道出现在列表中

#### 3.7 数据源管理
- [ ] 添加数据源
- [ ] 配置数据源类型（URLs/Files/Text）
- [ ] 上传文件或添加URL
- [ ] 验证数据源处理状态
- [ ] 验证数据源出现在列表中

### 4. 聊天功能测试

#### 4.1 Playground聊天
- [ ] 进入Playground页面
- [ ] 输入用户消息
- [ ] 发送消息
- [ ] 验证流式响应正常接收
- [ ] 验证助手回复正确显示
- [ ] 验证消息历史正确保存

#### 4.2 流式响应
- [ ] 发送消息
- [ ] 验证流式响应实时更新
- [ ] 验证响应完整显示

#### 4.3 工具调用
- [ ] 创建带工具的智能体
- [ ] 发送触发工具调用的消息
- [ ] 验证工具调用正确执行
- [ ] 验证工具结果正确显示

#### 4.4 多智能体协作
- [ ] 创建多个智能体
- [ ] 配置智能体handoff
- [ ] 发送消息触发handoff
- [ ] 验证handoff正确执行
- [ ] 验证多个智能体响应正确显示

### 5. Copilot功能测试

#### 5.1 Copilot对话
- [ ] 进入Copilot页面
- [ ] 输入提示词（如"创建一个客户支持智能体"）
- [ ] 验证Copilot响应
- [ ] 验证工作流自动创建

#### 5.2 Copilot智能体创建
- [ ] 通过Copilot创建智能体
- [ ] 验证智能体配置正确
- [ ] 验证智能体可正常使用

### 6. API密钥管理测试

#### 6.1 创建API密钥
- [ ] 进入项目设置
- [ ] 点击"创建API密钥"
- [ ] 输入密钥名称
- [ ] 创建密钥
- [ ] 验证密钥显示（仅显示前缀）
- [ ] 验证创建时返回完整密钥（仅一次）

#### 6.2 查看API密钥列表
- [ ] 查看API密钥列表
- [ ] 验证密钥信息正确显示
- [ ] 验证创建时间和最后使用时间显示

#### 6.3 删除API密钥
- [ ] 删除API密钥
- [ ] 验证删除确认对话框
- [ ] 验证密钥从列表中移除

### 7. 对话管理测试

#### 7.1 对话列表
- [ ] 进入对话页面
- [ ] 验证对话列表正常显示
- [ ] 验证对话按时间排序
- [ ] 验证对话分组（今天/本周/本月/更早）

#### 7.2 对话详情
- [ ] 点击对话查看详情
- [ ] 验证对话信息正确显示
- [ ] 验证所有回合正确显示
- [ ] 验证消息内容正确显示

### 8. 任务管理测试

#### 8.1 任务列表
- [ ] 进入任务页面
- [ ] 验证任务列表正常显示
- [ ] 验证任务状态正确显示
- [ ] 验证任务原因正确显示

#### 8.2 任务详情
- [ ] 点击任务查看详情
- [ ] 验证任务信息正确显示
- [ ] 验证任务输入输出正确显示

### 9. 触发器管理测试

#### 9.1 外部触发器
- [ ] 进入触发器页面
- [ ] 创建外部触发器
- [ ] 配置触发器
- [ ] 验证触发器出现在列表中

#### 9.2 一次性触发器
- [ ] 创建一次性触发器
- [ ] 配置触发时间和消息
- [ ] 验证触发器创建成功

#### 9.3 重复触发器
- [ ] 创建重复触发器
- [ ] 配置Cron表达式
- [ ] 配置触发消息
- [ ] 验证触发器创建成功

### 10. 项目设置测试

#### 10.1 项目配置
- [ ] 进入项目设置
- [ ] 验证项目信息正确显示
- [ ] 更新项目名称
- [ ] 更新Webhook URL
- [ ] 验证更改保存成功

#### 10.2 项目Secret
- [ ] 查看项目Secret
- [ ] 验证Secret正确显示
- [ ] 旋转Secret
- [ ] 验证新Secret生成

#### 10.3 Composio工具包
- [ ] 查看Composio工具包列表
- [ ] 连接工具包
- [ ] 验证连接状态
- [ ] 断开工具包连接

### 11. 中文本地化测试

#### 11.1 界面文本
- [ ] 验证所有界面文本为中文
- [ ] 验证无英文文本残留
- [ ] 验证品牌名称为"质信智购"

#### 11.2 错误消息
- [ ] 触发各种错误场景
- [ ] 验证错误消息为中文
- [ ] 验证错误消息清晰易懂

### 12. 错误处理和边界情况测试

#### 12.1 网络错误
- [ ] 模拟网络断开
- [ ] 验证错误处理
- [ ] 验证用户友好的错误提示

#### 12.2 无效输入
- [ ] 输入无效数据
- [ ] 验证输入验证
- [ ] 验证错误提示

#### 12.3 空状态
- [ ] 测试空项目列表
- [ ] 测试空对话列表
- [ ] 测试空任务列表
- [ ] 验证空状态提示正确显示

### 13. 性能测试

#### 13.1 页面加载
- [ ] 测量页面加载时间
- [ ] 验证页面在合理时间内加载完成

#### 13.2 API响应
- [ ] 测量API响应时间
- [ ] 验证API响应在合理时间内完成

#### 13.3 流式响应
- [ ] 测量流式响应首字节时间
- [ ] 验证流式响应流畅

## 测试执行步骤

1. **启动服务**
   - 启动后端服务（端口8001）
   - 启动前端服务（端口3001）
   - 确保数据库服务运行

2. **执行测试**
   - 按照测试计划逐项执行
   - 记录测试结果
   - 截图保存关键步骤

3. **问题记录**
   - 记录所有发现的问题
   - 记录问题复现步骤
   - 记录问题严重程度

4. **回归测试**
   - 修复问题后重新测试
   - 验证修复不影响其他功能

## 验收标准

- [ ] 所有测试用例通过
- [ ] 无严重bug
- [ ] 所有功能正常工作
- [ ] 性能指标达标
- [ ] 用户体验良好

---

**文档版本**：v1.0  
**创建日期**：2025-01-27  
**最后更新**：2025-01-27

