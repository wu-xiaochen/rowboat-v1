# å‰åç«¯å¯¹é½è®¡åˆ’
# Frontend-Backend Alignment Plan

## ğŸ“‹ å½“å‰çŠ¶æ€

### âœ… åç«¯å®ç°å®Œæˆ
- é¡¹ç›®ç®¡ç†å¢å¼ºåŠŸèƒ½ï¼š5ä¸ªç«¯ç‚¹ âœ…
- æ•°æ®æºç®¡ç†åŠŸèƒ½ï¼š6ä¸ªç«¯ç‚¹ âœ…
- å¯¹è¯ç®¡ç†åŠŸèƒ½ï¼š2ä¸ªç«¯ç‚¹ âœ…
- ä»»åŠ¡ç®¡ç†åŠŸèƒ½ï¼š2ä¸ªç«¯ç‚¹ âœ…
- **æ€»è®¡**: 15ä¸ªç«¯ç‚¹ï¼Œ27ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡ âœ…

### â³ å‰ç«¯å¯¹é½å¾…å®Œæˆ
- å‰ç«¯APIå®¢æˆ·ç«¯å·²åˆ›å»º (`backend-api-client.ts`) âœ…
- å‰ç«¯Actionséœ€è¦æ›´æ–°ä½¿ç”¨åç«¯API â³
- æ—§å®ç°éœ€è¦æ ‡è®°ä¸ºå·²å¼ƒç”¨ â³

## ğŸ¯ å¯¹é½ç­–ç•¥

### æ–¹æ¡ˆä¸€ï¼šæ¸è¿›å¼è¿ç§»ï¼ˆæ¨èï¼‰
1. ä¿æŒæ—§å®ç°å¯ç”¨ï¼ˆå‘åå…¼å®¹ï¼‰
2. åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨åç«¯API
3. é€æ­¥è¿ç§»ç°æœ‰ä»£ç 
4. æœ€åç§»é™¤æ—§å®ç°

### æ–¹æ¡ˆäºŒï¼šç›´æ¥æ›¿æ¢
1. ç›´æ¥æ›´æ–°Actionsä½¿ç”¨åç«¯API
2. ç«‹å³ç¦ç”¨æ—§å®ç°
3. é£é™©è¾ƒé«˜ï¼Œä½†æ›´å½»åº•

## ğŸ“ éœ€è¦æ›´æ–°çš„æ–‡ä»¶

### 1. æ•°æ®æºActions (`app/actions/data-source.actions.ts`)
éœ€è¦æ›´æ–°çš„æ–¹æ³•ï¼š
- `listDataSources()` - ä½¿ç”¨ `dataSourcesApiClient.list()`
- `getDataSource()` - ä½¿ç”¨ `dataSourcesApiClient.get()`
- `createDataSource()` - ä½¿ç”¨ `dataSourcesApiClient.create()`
- `updateDataSource()` - ä½¿ç”¨ `dataSourcesApiClient.update()`
- `deleteDataSource()` - ä½¿ç”¨ `dataSourcesApiClient.delete()`
- `toggleDataSource()` - ä½¿ç”¨ `dataSourcesApiClient.toggle()`

**æ³¨æ„**ï¼š
- åç«¯è¿”å›æ ¼å¼ï¼š`{ success: true, data: {...}, message: "..." }`
- éœ€è¦ä»`response.data`ä¸­æå–å®é™…æ•°æ®
- é”™è¯¯å¤„ç†éœ€è¦é€‚é…åç«¯æ ¼å¼

### 2. å¯¹è¯Actions (`app/actions/conversation.actions.ts`)
éœ€è¦æ›´æ–°çš„æ–¹æ³•ï¼š
- `listConversations()` - ä½¿ç”¨ `conversationsApiClient.list()`
- `fetchConversation()` - ä½¿ç”¨ `conversationsApiClient.get()`

**æ³¨æ„**ï¼š
- åç«¯è¿”å›æ ¼å¼ï¼š`{ success: true, data: { items: [...], nextCursor: ... }, message: "..." }`
- éœ€è¦ä¿æŒä¸ç°æœ‰å‰ç«¯ä»£ç çš„å…¼å®¹æ€§

### 3. ä»»åŠ¡Actions (`app/actions/job.actions.ts`)
éœ€è¦æ›´æ–°çš„æ–¹æ³•ï¼š
- `listJobs()` - ä½¿ç”¨ `jobsApiClient.list()`
- `fetchJob()` - ä½¿ç”¨ `jobsApiClient.get()`

**æ³¨æ„**ï¼š
- åç«¯è¿”å›æ ¼å¼ï¼š`{ success: true, data: { items: [...], nextCursor: ... }, message: "..." }`
- è¿‡æ»¤æ¡ä»¶éœ€è¦æ­£ç¡®ä¼ é€’

## ğŸ”§ å®æ–½æ­¥éª¤

### æ­¥éª¤1ï¼šæ›´æ–°æ•°æ®æºActions
1. å¯¼å…¥ `dataSourcesApiClient`
2. æ›´æ–°æ¯ä¸ªæ–¹æ³•ä½¿ç”¨åç«¯API
3. å¤„ç†å“åº”æ ¼å¼è½¬æ¢
4. ä¿æŒå‡½æ•°ç­¾åä¸å˜ï¼ˆå‘åå…¼å®¹ï¼‰

### æ­¥éª¤2ï¼šæ›´æ–°å¯¹è¯Actions
1. å¯¼å…¥ `conversationsApiClient`
2. æ›´æ–°æ–¹æ³•ä½¿ç”¨åç«¯API
3. å¤„ç†åˆ†é¡µå“åº”æ ¼å¼

### æ­¥éª¤3ï¼šæ›´æ–°ä»»åŠ¡Actions
1. å¯¼å…¥ `jobsApiClient`
2. æ›´æ–°æ–¹æ³•ä½¿ç”¨åç«¯API
3. å¤„ç†è¿‡æ»¤æ¡ä»¶

### æ­¥éª¤4ï¼šæµ‹è¯•éªŒè¯
1. æµ‹è¯•æ•°æ®æºåŠŸèƒ½
2. æµ‹è¯•å¯¹è¯åŠŸèƒ½
3. æµ‹è¯•ä»»åŠ¡åŠŸèƒ½
4. ç«¯åˆ°ç«¯æµ‹è¯•

### æ­¥éª¤5ï¼šæ ‡è®°æ—§å®ç°ä¸ºå·²å¼ƒç”¨
1. åœ¨æ—§Controllerså’ŒUse Casesä¸­æ·»åŠ `@deprecated`æ³¨é‡Š
2. æ·»åŠ è¿ç§»è¯´æ˜
3. è®¡åˆ’ç§»é™¤æ—¶é—´

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å“åº”æ ¼å¼å·®å¼‚**ï¼š
   - åç«¯è¿”å›ï¼š`{ success: true, data: {...}, message: "..." }`
   - å‰ç«¯æœŸæœ›ï¼šç›´æ¥è¿”å›æ•°æ®å¯¹è±¡
   - éœ€è¦åœ¨Actionsä¸­æå–`response.data`

2. **é”™è¯¯å¤„ç†**ï¼š
   - åç«¯é”™è¯¯æ ¼å¼ï¼š`{ success: false, error: { code, message, details } }`
   - éœ€è¦è½¬æ¢ä¸ºå‰ç«¯æœŸæœ›çš„é”™è¯¯æ ¼å¼

3. **ç±»å‹å…¼å®¹æ€§**ï¼š
   - ç¡®ä¿åç«¯è¿”å›çš„æ•°æ®ç»“æ„ä¸å‰ç«¯æœŸæœ›çš„ç±»å‹åŒ¹é…
   - å¯èƒ½éœ€è¦ç±»å‹è½¬æ¢æˆ–é€‚é…

4. **è®¤è¯**ï¼š
   - Server Actionséœ€è¦ä»æœåŠ¡å™¨ç«¯è°ƒç”¨åç«¯API
   - å¯èƒ½éœ€è¦ä¼ é€’ç”¨æˆ·è®¤è¯ä¿¡æ¯

## ğŸ“Š è¿›åº¦è·Ÿè¸ª

- [ ] æ›´æ–°æ•°æ®æºActions
- [ ] æ›´æ–°å¯¹è¯Actions
- [ ] æ›´æ–°ä»»åŠ¡Actions
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•
- [ ] æ ‡è®°æ—§å®ç°ä¸ºå·²å¼ƒç”¨

---

**æœ€åæ›´æ–°**: 2025-01-27  
**çŠ¶æ€**: â³ å¾…å®æ–½

